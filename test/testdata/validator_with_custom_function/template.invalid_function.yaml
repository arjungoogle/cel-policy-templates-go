apiVersion: policy.acme.co/v1
kind: PolicyTemplate
metadata:
  name: validator_with_custom_function
schema:
  type: object
  description: Policy with validator referencing to custom function.
  properties:
    port:
      description: >
        port contains a string which could be a range ex : "22-44" or "22".
        It has to be a positive number and less than 65535
      type: string
validator:
  productions:
  - match: invalidFunc(rule.port) < 0
    message: "invalidFunc"

evaluator:
  productions:
  - match: rule.port != ''
    decision: policy.report
    output: rule.port